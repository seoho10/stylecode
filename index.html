<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StyleCode Analytics Enterprise Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;800&display=swap');
        body { font-family: 'Pretendard', sans-serif; background-color: #f1f5f9; font-size: 13px; color: #1e293b; }
        
        .table-container { height: 320px; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 12px; background: white; box-shadow: inset 0 2px 4px rgba(0,0,0,0.02); }
        table { width: 100%; border-collapse: separate; border-spacing: 0; }
        th { position: sticky; top: 0; background: #f8fafc; z-index: 20; border-bottom: 1px solid #e2e8f0; padding: 12px 10px; font-size: 0.75rem; color: #64748b; font-weight: 700; text-align: left; }
        td { padding: 10px; border-bottom: 1px solid #f1f5f9; font-size: 0.8rem; }
        
        .section-title { font-size: 0.95rem; font-weight: 800; margin-bottom: 0.75rem; color: #0f172a; display: flex; justify-content: space-between; align-items: center; }
        
        .selected-online { background-color: #eff6ff !important; font-weight: 700; color: #1d4ed8; border-left: 4px solid #3b82f6; }
        .selected-offline { background-color: #fef2f2 !important; font-weight: 700; color: #b91c1c; border-left: 4px solid #ef4444; }
        .selected-customer { background-color: #f5f3ff !important; font-weight: 700; color: #7c3aed; border-left: 4px solid #8b5cf6; }
        .clickable-row { cursor: pointer; transition: background 0.2s; }
        .clickable-row:hover { background-color: #f8fafc; }
        
        .btn-toggle { padding: 5px 12px; font-size: 0.7rem; font-weight: 700; border-radius: 6px; transition: all 0.2s; }
        .btn-active { background-color: white; color: #1e293b; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border: 1px solid #e2e8f0; }
        .btn-inactive { color: #94a3b8; border: 1px solid transparent; }
        .control-group { background-color: #e2e8f0; padding: 3px; border-radius: 8px; display: flex; gap: 2px; }
        
        .group-header { border-bottom: 4px solid #0f172a; padding-bottom: 0.75rem; margin: 3rem 0 1.5rem 0; }
        .badge { font-size: 10px; padding: 2px 8px; border-radius: 9999px; font-weight: 800; }

        .select2-container { width: 100% !important; }
        .select2-selection--multiple { border: 1px solid #e2e8f0 !important; border-radius: 8px !important; padding: 2px 6px !important; background-color: #f8fafc !important; }
    </style>
</head>
<body class="p-8">
    <div class="max-w-[1600px] mx-auto">
        
        <header class="flex justify-between items-end mb-8">
            <div>
                <h1 class="text-3xl font-black tracking-tighter text-slate-900">StyleCode Data Lab <span class="text-blue-600">v2.9</span></h1>
                <p class="text-slate-500 font-medium">실시간 판매 성과 및 고객 분석 통합 대시보드</p>
            </div>
            <button onclick="fetchAll()" class="bg-slate-900 text-white px-10 py-3 rounded-xl font-bold hover:bg-slate-800 transition transform active:scale-95 shadow-xl">DATA REFRESH</button>
        </header>

        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 mb-10">
            <div class="grid grid-cols-1 md:grid-cols-12 gap-6">
                <div class="md:col-span-2">
                    <label class="block text-[10px] font-black text-slate-400 mb-2 uppercase tracking-widest">Brand Selection</label>
                    <select id="brand" class="w-full border-slate-200 rounded-lg px-4 py-2.5 bg-slate-50 font-bold focus:ring-2 focus:ring-blue-500 outline-none">
                        <option>NIKE PERFORMANCE</option><option>ADIDAS ORIGINALS</option><option>NEW BALANCE</option>
                    </select>
                </div>
                <div class="md:col-span-3">
                    <label class="block text-[10px] font-black text-slate-400 mb-2 uppercase tracking-widest">Category</label>
                    <select id="category" class="js-example-basic-multiple" multiple="multiple">
                        <option value="shoes" selected>FOOTWEAR</option><option value="top">TOPS</option><option value="bottom">PANTS</option><option value="acc">ACCESSORIES</option>
                    </select>
                </div>
                <div class="md:col-span-4">
                    <label class="block text-[10px] font-black text-slate-400 mb-2 uppercase tracking-widest">Style Code</label>
                    <select id="styleCode" class="js-example-basic-multiple" multiple="multiple">
                        <option value="SC-001" selected>SC-AIR-01</option><option value="SC-002">SC-RUN-05</option><option value="SC-003">SC-CT-09</option>
                        <option value="SC-004">SC-LIFESTYLE-X</option><option value="SC-005">SC-PRO-CHAMP</option>
                    </select>
                </div>
                <div class="md:col-span-3">
                    <label class="block text-[10px] font-black text-slate-400 mb-2 uppercase tracking-widest">Analysis Period</label>
                    <div class="flex items-center gap-2 bg-slate-50 border border-slate-200 rounded-lg px-4 py-2">
                        <input type="date" id="startDate" class="bg-transparent font-bold text-xs outline-none cursor-pointer">
                        <span class="text-slate-300 font-bold">~</span>
                        <input type="date" id="endDate" class="bg-transparent font-bold text-xs outline-none cursor-pointer">
                    </div>
                </div>
            </div>
        </div>

        <div id="group-1">
            <div class="group-header flex justify-between items-center">
                <h2 class="text-2xl font-black text-slate-900 tracking-tight">1. ON/OFF PERFORMANCE</h2>
                <span class="text-slate-400 font-bold text-sm">CHANNEL & PRODUCT ANALYSIS</span>
            </div>

            <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200 mb-10">
                <div class="flex justify-between items-start mb-8">
                    <div>
                        <h3 class="text-lg font-extrabold text-slate-800">통합 매출 및 판매량 추이</h3>
                        <p class="text-sm text-slate-400 mt-1">온라인과 오프라인의 전체 성과를 비교합니다.</p>
                    </div>
                    <div class="flex gap-4">
                        <div class="control-group">
                            <button id="main-sales" onclick="setChart('main', 'metric', 'sales')" class="btn-toggle btn-active">매출액</button>
                            <button id="main-qty" onclick="setChart('main', 'metric', 'qty')" class="btn-toggle btn-inactive">판매량</button>
                        </div>
                        <div class="control-group">
                            <button id="main-daily" onclick="setChart('main', 'view', 'daily')" class="btn-toggle btn-active">일</button>
                            <button id="main-weekly" onclick="setChart('main', 'view', 'weekly')" class="btn-toggle btn-inactive">주</button>
                            <button id="main-monthly" onclick="setChart('main', 'view', 'monthly')" class="btn-toggle btn-inactive">월</button>
                        </div>
                    </div>
                </div>
                <div style="height: 350px;"><canvas id="mainChart"></canvas></div>
            </div>

            <div class="mb-16">
                <div class="flex items-center gap-3 mb-6">
                    <div class="w-2 h-8 bg-blue-600 rounded-full"></div>
                    <h3 class="text-xl font-black text-slate-800 uppercase tracking-tight">Online Performance Detailed</h3>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
                    <div>
                        <div class="section-title"><span>온라인 채널별 실적</span></div>
                        <div class="table-container">
                            <table>
                                <thead><tr><th>채널명</th><th>매출액</th><th>수량</th><th>비중</th></tr></thead>
                                <tbody id="on-list">
                                    <tr id="on-total-row" class="clickable-row selected-online" onclick="updateIndicator('on', '온라인 전체', this)"><td>온라인 전체</td><td>452,100,000</td><td>3,500</td><td>100%</td></tr>
                                    <tr class="clickable-row" onclick="updateIndicator('on', '자사몰', this)"><td class="pl-6 text-slate-500">└ 자사몰</td><td>135,630,000</td><td>1,050</td><td>30%</td></tr>
                                    <tr class="clickable-row" onclick="updateIndicator('on', '무신사', this)"><td class="pl-6 text-slate-500">└ 무신사</td><td>113,025,000</td><td>875</td><td>25%</td></tr>
                                    <tr class="clickable-row" onclick="updateIndicator('on', '네이버 스토어', this)"><td class="pl-6 text-slate-500">└ 네이버 스토어</td><td>90,420,000</td><td>700</td><td>20%</td></tr>
                                    <tr class="clickable-row" onclick="updateIndicator('on', '29CM', this)"><td class="pl-6 text-slate-500">└ 29CM</td><td>67,815,000</td><td>525</td><td>15%</td></tr>
                                    <tr class="clickable-row" onclick="updateIndicator('on', 'W컨셉', this)"><td class="pl-6 text-slate-500">└ W컨셉</td><td>45,210,000</td><td>350</td><td>10%</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div>
                        <div class="section-title"><span>컬러별 판매 현황</span><span id="on-t-color" class="badge bg-blue-100 text-blue-600">온라인 전체</span></div>
                        <div class="table-container"><table id="on-color-table"><thead><tr><th>컬러</th><th>판매수량</th><th>점유율</th></tr></thead><tbody id="on-color-body"></tbody></table></div>
                    </div>
                    <div>
                        <div class="section-title"><span>사이즈별 판매 현황</span><span id="on-t-size" class="badge bg-blue-100 text-blue-600">온라인 전체</span></div>
                        <div class="table-container"><table id="on-size-table"><thead><tr><th>사이즈</th><th>판매수량</th><th>점유율</th></tr></thead><tbody id="on-size-body"></tbody></table></div>
                    </div>
                </div>
            </div>

            <div class="mb-16">
                <div class="flex items-center gap-3 mb-6">
                    <div class="w-2 h-8 bg-red-600 rounded-full"></div>
                    <h3 class="text-xl font-black text-slate-800 uppercase tracking-tight">Offline Performance Detailed</h3>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
                    <div>
                        <div class="section-title"><span>오프라인 채널별 실적</span></div>
                        <div class="table-container">
                            <table>
                                <thead><tr><th>채널명</th><th>매출액</th><th>수량</th><th>비중</th></tr></thead>
                                <tbody id="off-list">
                                    <tr id="off-total-row" class="clickable-row selected-offline" onclick="updateIndicator('off', '오프라인 전체', this)"><td>오프라인 전체</td><td>320,000,000</td><td>2,800</td><td>100%</td></tr>
                                    <tr class="clickable-row" onclick="updateIndicator('off', '백화점', this)"><td class="pl-6 text-slate-500">└ 백화점</td><td>224,000,000</td><td>1,960</td><td>70%</td></tr>
                                    <tr class="clickable-row" onclick="updateIndicator('off', '대리점', this)"><td class="pl-6 text-slate-500">└ 대리점</td><td>64,000,000</td><td>560</td><td>20%</td></tr>
                                    <tr class="clickable-row" onclick="updateIndicator('off', '직영점', this)"><td class="pl-6 text-slate-500">└ 직영점</td><td>32,000,000</td><td>280</td><td>10%</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div>
                        <div class="section-title"><span>컬러별 판매</span><span id="off-t-color" class="badge bg-red-100 text-red-600">오프라인 전체</span></div>
                        <div class="table-container"><table id="off-color-table"><thead><tr><th>컬러</th><th>판매수량</th><th>비중</th></tr></thead><tbody id="off-color-body"></tbody></table></div>
                    </div>
                    <div>
                        <div class="section-title"><span>사이즈별 판매</span><span id="off-t-size" class="badge bg-red-100 text-red-600">오프라인 전체</span></div>
                        <div class="table-container"><table id="off-size-table"><thead><tr><th>사이즈</th><th>판매수량</th><th>비중</th></tr></thead><tbody id="off-size-body"></tbody></table></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="group-2" class="pb-20">
            <div class="group-header flex justify-between items-center">
                <h2 class="text-2xl font-black text-slate-900 tracking-tight">2. CUSTOMER ANALYSIS</h2>
                <span class="text-slate-400 font-bold text-sm">CUSTOMER SEGMENT & BEHAVIOR</span>
            </div>

            <div class="mb-16">
                <div class="flex items-center gap-3 mb-6">
                    <div class="w-2 h-8 bg-purple-600 rounded-full"></div>
                    <h3 class="text-xl font-black text-slate-800 uppercase tracking-tight">CUSTOMER Performance Detailed</h3>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
                    <div>
                        <div class="section-title"><span>고객 채널별 실적</span></div>
                        <div class="table-container">
                            <table>
                                <thead><tr><th>채널명</th><th>매출액</th><th>수량</th><th>비중</th></tr></thead>
                                <tbody id="cust-list">
                                    <tr class="clickable-row selected-customer" onclick="updateCustomerDetail('회원 전체', this)">
                                        <td class="font-bold">회원 전체</td><td>772,100,000</td><td>6,300</td><td>100%</td>
                                    </tr>
                                    <tr class="clickable-row" onclick="updateCustomerDetail('온라인', this)">
                                        <td class="pl-5 font-semibold text-blue-600">└ 온라인</td><td>452,100,000</td><td>3,500</td><td>58.5%</td>
                                    </tr>
                                    <tr class="clickable-row" onclick="updateCustomerDetail('자사몰', this)">
                                        <td class="pl-10 text-slate-500">└ 자사몰</td><td>452,100,000</td><td>3,500</td><td>100%</td>
                                    </tr>
                                    <tr class="clickable-row" onclick="updateCustomerDetail('오프라인', this)">
                                        <td class="pl-5 font-semibold text-red-600">└ 오프라인</td><td>320,000,000</td><td>2,800</td><td>41.5%</td>
                                    </tr>
                                    <tr class="clickable-row" onclick="updateCustomerDetail('백화점', this)">
                                        <td class="pl-10 text-slate-500">└ 백화점</td><td>224,000,000</td><td>1,960</td><td>70%</td>
                                    </tr>
                                    <tr class="clickable-row" onclick="updateCustomerDetail('대리점', this)">
                                        <td class="pl-10 text-slate-500">└ 대리점</td><td>64,000,000</td><td>560</td><td>20%</td>
                                    </tr>
                                    <tr class="clickable-row" onclick="updateCustomerDetail('직영점', this)">
                                        <td class="pl-10 text-slate-500">└ 직영점</td><td>32,000,000</td><td>280</td><td>10%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div>
                        <div class="section-title"><span>컬러별 판매 현황</span><span id="cust-t-color" class="badge bg-purple-100 text-purple-600">회원 전체</span></div>
                        <div class="table-container"><table><thead><tr><th>컬러</th><th>판매수량</th><th>점유율</th></tr></thead><tbody id="cust-color-body"></tbody></table></div>
                    </div>
                    <div>
                        <div class="section-title"><span>사이즈별 판매 현황</span><span id="cust-t-size" class="badge bg-purple-100 text-purple-600">회원 전체</span></div>
                        <div class="table-container"><table><thead><tr><th>사이즈</th><th>판매수량</th><th>점유율</th></tr></thead><tbody id="cust-size-body"></tbody></table></div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-white p-10 rounded-2xl border border-dashed border-slate-300 text-center flex flex-col items-center justify-center">
                    <div class="text-purple-600 mb-4"><svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg></div>
                    <p class="font-bold text-slate-800">성별/연령대 분포</p><p class="text-xs text-slate-400 mt-2">Coming Soon</p>
                </div>
                <div class="bg-white p-10 rounded-2xl border border-dashed border-slate-300 text-center flex flex-col items-center justify-center">
                    <div class="text-purple-600 mb-4"><svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v5a2 2 0 01-2 2h-2"></path></svg></div>
                    <p class="font-bold text-slate-800">구매 유입 경로</p><p class="text-xs text-slate-400 mt-2">Coming Soon</p>
                </div>
                <div class="bg-white p-10 rounded-2xl border border-dashed border-slate-300 text-center flex flex-col items-center justify-center">
                    <div class="text-purple-600 mb-4"><svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg></div>
                    <p class="font-bold text-slate-800">신규 vs 재구매 분석</p><p class="text-xs text-slate-400 mt-2">Coming Soon</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const DATA = {
            on: {
                '온라인 전체': { qty: 3500, colors: {BLACK: 1500, WHITE: 1000, GREY: 600, NAVY: 400}, sizes: {'230': 400, '240': 900, '250': 1200, '260': 700} },
                '자사몰': { qty: 1050, colors: {BLACK: 450, WHITE: 350, GREY: 150}, sizes: {'230': 100, '240': 300, '250': 350} },
                '무신사': { qty: 875, colors: {BLACK: 400, WHITE: 200}, sizes: {'240': 275, '250': 300} },
                '네이버 스토어': { qty: 700, colors: {BLACK: 300, WHITE: 250}, sizes: {'230': 150, '240': 250} },
                '29CM': { qty: 525, colors: {BLACK: 200, WHITE: 150}, sizes: {'230': 100, '240': 200} },
                'W컨셉': { qty: 350, colors: {BLACK: 150, WHITE: 50}, sizes: {'230': 50, '240': 100} }
            },
            off: {
                '오프라인 전체': { qty: 2800, colors: {BLACK: 1800, BEIGE: 600, WHITE: 400}, sizes: {'250': 800, '260': 1000, '270': 1000}, geo: {서울: 1200, 경기: 800, 부산: 300, 대구: 200, 광주: 100, 대전: 100, 제주: 100} },
                '백화점': { qty: 1960, colors: {BLACK: 1300, BEIGE: 400, WHITE: 260}, sizes: {'250': 500, '260': 700, '270': 760}, geo: {서울: 1000, 경기: 500, 부산: 200, 대구: 100, 기타: 160} },
                '대리점': { qty: 560, colors: {BLACK: 300, BEIGE: 160, WHITE: 100}, sizes: {'250': 200, '260': 200, '270': 160}, geo: {서울: 100, 경기: 200, 부산: 100, 대구: 100, 광주: 60} },
                '직영점': { qty: 280, colors: {BLACK: 200, BEIGE: 40, WHITE: 40}, sizes: {'250': 100, '260': 100, '270': 80}, geo: {서울: 100, 경기: 100, 부산: 80} }
            },
            cust: {
                '회원 전체': { qty: 6300, colors: {BLACK: 3000, WHITE: 2000, GREY: 1300}, sizes: {'240': 1500, '250': 2500, '260': 2300} },
                '온라인': { qty: 3500, colors: {BLACK: 1500, WHITE: 1200, GREY: 800}, sizes: {'240': 1000, '250': 1500, '260': 1000} },
                '자사몰': { qty: 3500, colors: {BLACK: 1500, WHITE: 1200, GREY: 800}, sizes: {'240': 1000, '250': 1500, '260': 1000} },
                '오프라인': { qty: 2800, colors: {BLACK: 1500, BEIGE: 800, WHITE: 500}, sizes: {'250': 1000, '260': 1300, '270': 500} },
                '백화점': { qty: 1960, colors: {BLACK: 1000, BEIGE: 600, WHITE: 360}, sizes: {'250': 700, '260': 900, '270': 360} },
                '대리점': { qty: 560, colors: {BLACK: 300, BEIGE: 150, WHITE: 110}, sizes: {'250': 200, '260': 260, '270': 100} },
                '직영점': { qty: 280, colors: {BLACK: 200, BEIGE: 50, WHITE: 30}, sizes: {'250': 100, '260': 140, '270': 40} }
            }
        };

        const states = {
            main: { metric: 'sales', view: 'daily', chart: null },
            on: { metric: 'sales', view: 'daily', chart: null, selectedChannel: '온라인 전체' },
            off: { metric: 'sales', view: 'daily', chart: null, selectedChannel: '오프라인 전체' }
        };

        $(document).ready(function() {
            $('.js-example-basic-multiple').select2({ placeholder: "선택하세요" });
            fetchAll();
            updateCustomerDetail('회원 전체', $('#cust-list tr').first());
        });

        // 1번 그룹용 업데이트 함수
        function updateIndicator(type, name, rowElement) {
            const container = document.getElementById(`${type}-list`);
            Array.from(container.querySelectorAll('tr')).forEach(r => r.classList.remove(type === 'on' ? 'selected-online' : 'selected-offline'));
            if(rowElement) rowElement.classList.add(type === 'on' ? 'selected-online' : 'selected-offline');
            document.getElementById(`${type}-t-color`).innerText = name;
            document.getElementById(`${type}-t-size`).innerText = name;
            const d = DATA[type][name];
            fillTable(`${type}-color-body`, d.colors, d.qty);
            fillTable(`${type}-size-body`, d.sizes, d.qty);
        }

        // 2번 그룹용 업데이트 함수 (신규)
        function updateCustomerDetail(name, rowElement) {
            $('#cust-list tr').removeClass('selected-customer');
            $(rowElement).addClass('selected-customer');
            $('#cust-t-color').text(name);
            $('#cust-t-size').text(name);
            const d = DATA.cust[name];
            fillTable('cust-color-body', d.colors, d.qty);
            fillTable('cust-size-body', d.sizes, d.qty);
        }

        function fillTable(id, obj, total) {
            const b = document.getElementById(id); b.innerHTML = '';
            Object.entries(obj).forEach(([k, v]) => {
                b.innerHTML += `<tr><td>${k}</td><td class="font-bold">${v.toLocaleString()}</td><td class="text-slate-400">${((v/total)*100).toFixed(1)}%</td></tr>`;
            });
        }

        function setChart(key, type, val) {
            states[key][type] = val;
            $(`#${key}-${val}`).siblings().removeClass('btn-active').addClass('btn-inactive');
            $(`#${key}-${val}`).addClass('btn-active').removeClass('btn-inactive');
            renderSingleChart(key);
        }

        function renderSingleChart(key) {
            const canvasEl = document.getElementById(`${key}Chart`);
            if(!canvasEl) return;
            const s = states[key];
            if (s.chart) s.chart.destroy();
            let labels = ['01-12', '01-13', '01-14', '01-15', '01-16'];
            let ds = key === 'main' ? [
                { label: 'ONLINE', data: [320, 450, 380, 520, 480].map(v => s.metric === 'sales' ? v*60000 : v), borderColor: '#2563eb', tension: 0.4 },
                { label: 'OFFLINE', data: [280, 310, 290, 410, 390].map(v => s.metric === 'sales' ? v*70000 : v), borderColor: '#dc2626', tension: 0.4 }
            ] : [{ label: s.selectedChannel, data: [100, 150, 130, 180, 160].map(v => s.metric === 'sales' ? v*55000 : v), borderColor: '#3b82f6', tension: 0.4 }];
            
            s.chart = new Chart(canvasEl.getContext('2d'), {
                type: 'line',
                data: { labels, datasets: ds },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } }
            });
        }

        function fetchAll() { 
            renderSingleChart('main'); renderSingleChart('on'); renderSingleChart('off'); 
            updateIndicator('on', '온라인 전체', document.getElementById('on-total-row'));
            updateIndicator('off', '오프라인 전체', document.getElementById('off-total-row'));
        }
    </script>
</body>
</html>